nginx 日志说明

请求url ：/api/zyuc/nginx/log/list

请求方式：GET

请求参数：

| 参数名       | 类型    | 是否可为空 | 描述                                 |
| ------------ | ------- | ---------- | ------------------------------------ |
| pageNo       | integer | 否         | 默认为1，当前页数                    |
| pageSize     | integer | 否         | 默认为10 ，查询个数                  |
| customerId| String  | 是         | 客户编码                             |
| customerName | String  | 是         | 客户名称，支持模糊查询               |
| accesskey    | String  | 是         | 客户的accesskey                      |
| object       | String  | 是         | 操作对象,如压制是ip ，域名无忧是网址 |
| begin        | String  | 是         | 开始时间 毫秒值                      |
| end          | String  | 是         | 结束时间 毫秒值                      |
| module       | string  | 是         | 模块                                 |
| traceId      | string  | 是         | 调用链                               |



返回参数：

| 字段名称 | 类型         | 说明               |
| -------- | ------------ | ------------------ |
| code     | integer      | 200: 表示 请求成功 |
| message  | string       |                    |
| result   | Page<object> |                    |

Page

| 字段名称   | 类型           | 说明       |
| ---------- | -------------- | ---------- |
| results    | List<NginxLog> | 请求对象列 |
| totalCount | Integer        | 总条数     |

NginxLog

| 字段名称        | 类型    | 说明                         |
| --------------- | ------- | ---------------------------- |
*| traceId         | string  | 调用链                       |
| seqno           | string  | 序列号，-1                   |
| request         | string  | 请求体                       |
| response        | string  | 返回参数                     |
| tonce           | string  | tonce                        |
| accesskey       | string  | 客户acccesskey               |
*| url             | string  | 请求url                      |
*| beginMs         | integer | 开始时间的毫秒值             |
| endMs           | integer | 结束时间的毫秒值             |
*| spendMS         | integer | 响应的毫秒值                 |
| component       | string  | 组件                         |
*| module          | string  | 模块                         |
| httpMethod      | string  | http请求方式                 |
| userId          | string  | 请求ip                       |
*| status          | integer | http响应状态码，200 表示成功 |
*| customerId    | string  | 客户编码                     |
*| customerName    | string  | 客户名称                     |
*| object          | string  | 操作对象                     |
| responseCode    | string  | 响应编码                     |
*| responseMessage | string  | 响应message                  |
| userAgent       | string  | userAgent                    |

列表显示：traceId ,客户编码，客户名称，操作对象，开始时间，时延，http响应状态码，module，请求url,响应消息体,  
详情按钮里显示：tonce，accesskey，客户名称，userAgent，url，httpMethod，userId，请求体 ，响应参数

示例：

请求：http://127.0.0.1:8402/threat-intelligence-log/api/nginx/log/list?traceId=1626892635fda12434a8bb4256108a8a

响应：

{

  "code": 200,

  "message": "请求成功",

  "result": {

​    "results": [

​      {

​        "traceId": "1626892635fda12434a8bb4256108a8a",

​        "seqno": "-1",

​        "request": "\"{\"customerId\":\"203509\",\"domain\":\"changdu.gov.cn\",\"domainName\":\"www\",\"openType\":0,\"wafProtocolType\":0,\"wafSourceIp\":\"113.62.176.97\",\"wafSourcePort\":\"80\"}\"",

         "response": "\"<html>\r\n<head><title>504GatewayTime-out</title></head>\r\n<bodybgcolor=\"white\">\r\n<center><h1>504GatewayTime-out</h1></center>\r\n<hr><center>nginx</center>\r\n</body>\r\n</html>\r\n\"",

​        "begin": 1626892634000, //不用

​        "end": 1626892695000,  //不用

​        "spendMS": 60032,  

​        "beginMs": 1626892634968, //使用

​        "endMs": 1626892695000, //使用

​        "component": "zyuc",

​        "module": "",

​        "httpMethod": "POST",

​        "userId": "36.111.137.176",

​        "source": "nginx",

​        "status": "504",

​        "userAgent": "Apache-HttpClient/4.5.2(Java/1.8.0_131)",

​        "tonce": "1626892635493000",

​        "accesskey": "8334a8f304591e3cbc3fbde61f8778f2"

​      }

​    ],

​    "totalCount": 1

  }

}



//v2
{

  "code": 200,

  "message": "请求成功",

  "result": {

​    "results": [

​      {

​        "traceId": "1626892635fda12434a8bb4256108a8a",

​        "seqno": "-1",

​        "request": "\"{\"customerId\":\"203509\",\"domain\":\"changdu.gov.cn\",\"domainName\":\"www\",\"openType\":0,\"wafProtocolType\":0,\"wafSourceIp\":\"113.62.176.97\",\"wafSourcePort\":\"80\"}\"",

         "response": "\"<html>\r\n<head><title>504GatewayTime-out</title></head>\r\n<bodybgcolor=\"white\">\r\n<center><h1>504GatewayTime-out</h1></center>\r\n<hr><center>nginx</center>\r\n</body>\r\n</html>\r\n\"",

        "url":"/api/v2/wafConfig/closePort",

​        "begin": 1626892634000, //不用

​        "end": 1626892695000,  //不用

​        "spendMS": 60032,  

​        "beginMs": 1626892634968, //使用

​        "endMs": 1626892695000, //使用

​        "component": "zyuc",

​        "module": "",

​        "httpMethod": "POST",

​        "userId": "36.111.137.176",
        "userName":"",

​        "source": "nginx",

​        "status": "504",
        "customerName":"天翼云专用对接帐号",


​        "userAgent": "Apache-HttpClient/4.5.2(Java/1.8.0_131)",

​        "tonce": "1626892635493000",

​        "accesskey": "8334a8f304591e3cbc3fbde61f8778f2"

​      }

​    ],

​    "totalCount": 1

  }

}














 